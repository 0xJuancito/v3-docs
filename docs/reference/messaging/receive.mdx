import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Receive a message

Contracts can receive interchain messages by implementing the `handle` function.

## Handle

This function is called by the `Mailbox` contract when a message is received.

:::danger
To ensure only valid interchain messages are accepted, it is important to restrict [access control](##access-control) to the Mailbox address.
:::

<Tabs groupId="lang">
<TabItem value="sol" label="Solidity">

```solidity file=<rootDir>/static/contracts/interfaces/IMessageRecipient.sol#L5-L9
```

**Parameters**

|Name|Type|Description|
|----|----|-----------|
|`_origin`|`uint32`|Domain of origin chain|
|`_sender`|`bytes32`|Address of sender on origin chain as bytes32|
|`_messageBody`|`bytes`|Raw bytes content of message body|

:::tip
Sender addresses are left-padded to `bytes32` for compatibility with virtual machines that are addressed differently.
:::

The following utility is provided in the [`TypeCasts` library](../libraries/typecasts.mdx "mention") for convenience.
```solidity file=<rootDir>/static/contracts/libs/TypeCasts.sol#L10-L13
```

</TabItem>
<TabItem value="cw" label="CosmWasm">

Docs coming soon!

</TabItem>
<TabItem value="sl" label="Sealevel">

Docs coming soon!

</TabItem>
</Tabs>

## Access Control

Examples of valid Mailbox access control are included below.

<Tabs groupId="lang">
<TabItem value="sol" label="Solidity">

```solidity
modifier onlyMailbox() {
    require(msg.sender == mailbox);
    _;
}

function handle(
    uint32 _origin,
    bytes32 _sender,
    bytes calldata _body
) external onlyMailbox {};
```

</TabItem>
<TabItem value="cw" label="CosmWasm">

Docs coming soon!

</TabItem>
<TabItem value="sl" label="Sealevel">

Docs coming soon!

</TabItem>
</Tabs>

## Modular Security

{/* TODO: links */}
To leverage Hyperlane's modular security, message recipients can specify a custom Interchain Security Module to **verify anything** about incoming messages.

<Tabs groupId="lang">
<TabItem value="sol" label="Solidity">

```solidity file=<rootDir>/static/contracts/interfaces/IInterchainSecurityModule.sol#L37-L40
```

</TabItem>
<TabItem value="cw" label="CosmWasm">

Docs coming soon!

</TabItem>
<TabItem value="sl" label="Sealevel">

Docs coming soon!

</TabItem>
</Tabs>

### Examples

Example `handle` implementations are included below for reference.

<Tabs groupId="lang">
<TabItem value="sol" label="Solidity">

```solidity file=<rootDir>/static/contracts/test/TestRecipient.sol#L30-L38
```

</TabItem>
<TabItem value="cw" label="CosmWasm">

Docs coming soon!

</TabItem>
<TabItem value="sl" label="Sealevel">

Docs coming soon!

</TabItem>
</Tabs>
